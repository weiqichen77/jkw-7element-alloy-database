<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ç½‘é¡µå¹¶å‘åŠ è½½æµ‹è¯•å·¥å…·</title>
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Arial, 'Microsoft YaHei', sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      padding: 20px;
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
    }

    .header {
      background: white;
      border-radius: 12px;
      padding: 30px;
      margin-bottom: 20px;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }

    h1 {
      color: #2c3e50;
      font-size: 28px;
      margin-bottom: 10px;
    }

    .subtitle {
      color: #7f8c8d;
      font-size: 14px;
    }

    .config-panel {
      background: white;
      border-radius: 12px;
      padding: 30px;
      margin-bottom: 20px;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }

    .form-group {
      margin-bottom: 20px;
    }

    label {
      display: block;
      color: #2c3e50;
      font-weight: 600;
      margin-bottom: 8px;
      font-size: 14px;
    }

    input[type="text"],
    input[type="number"] {
      width: 100%;
      padding: 12px;
      border: 2px solid #e0e0e0;
      border-radius: 8px;
      font-size: 14px;
      transition: border-color 0.3s;
    }

    input:focus {
      outline: none;
      border-color: #667eea;
    }

    .input-hint {
      color: #95a5a6;
      font-size: 12px;
      margin-top: 5px;
    }

    .button-group {
      display: flex;
      gap: 15px;
      margin-top: 25px;
    }

    button {
      flex: 1;
      padding: 14px 20px;
      border: none;
      border-radius: 8px;
      font-size: 15px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s;
    }

    .btn-primary {
      background: #667eea;
      color: white;
    }

    .btn-primary:hover:not(:disabled) {
      background: #5568d3;
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
    }

    .btn-secondary {
      background: #e0e0e0;
      color: #2c3e50;
    }

    .btn-secondary:hover:not(:disabled) {
      background: #d0d0d0;
    }

    button:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }

    .progress-panel {
      background: white;
      border-radius: 12px;
      padding: 30px;
      margin-bottom: 20px;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      display: none;
    }

    .progress-panel.show {
      display: block;
    }

    .progress-bar-container {
      background: #f0f0f0;
      border-radius: 10px;
      height: 30px;
      overflow: hidden;
      margin: 20px 0;
    }

    .progress-bar {
      height: 100%;
      background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
      width: 0%;
      transition: width 0.3s;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-size: 12px;
      font-weight: 600;
    }

    .status-text {
      text-align: center;
      color: #7f8c8d;
      font-size: 14px;
    }

    .results-panel {
      background: white;
      border-radius: 12px;
      padding: 30px;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      display: none;
    }

    .results-panel.show {
      display: block;
    }

    .score-display {
      text-align: center;
      padding: 40px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      border-radius: 12px;
      color: white;
      margin-bottom: 30px;
    }

    .score-number {
      font-size: 72px;
      font-weight: 700;
      margin: 10px 0;
    }

    .score-grade {
      font-size: 36px;
      font-weight: 600;
      margin-bottom: 10px;
    }

    .score-desc {
      font-size: 18px;
      opacity: 0.9;
    }

    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 20px;
      margin-bottom: 30px;
    }

    .stat-card {
      background: #f8f9fa;
      padding: 20px;
      border-radius: 8px;
      border-left: 4px solid #667eea;
    }

    .stat-label {
      color: #7f8c8d;
      font-size: 12px;
      font-weight: 600;
      text-transform: uppercase;
      margin-bottom: 8px;
    }

    .stat-value {
      color: #2c3e50;
      font-size: 24px;
      font-weight: 700;
    }

    .stat-unit {
      color: #95a5a6;
      font-size: 14px;
      margin-left: 5px;
    }

    .details-table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
    }

    .details-table th {
      background: #f8f9fa;
      padding: 12px;
      text-align: left;
      font-weight: 600;
      color: #2c3e50;
      font-size: 13px;
      border-bottom: 2px solid #e0e0e0;
    }

    .details-table td {
      padding: 12px;
      border-bottom: 1px solid #f0f0f0;
      color: #555;
      font-size: 13px;
    }

    .recommendations {
      background: #fff3cd;
      border-left: 4px solid #ffc107;
      padding: 20px;
      border-radius: 8px;
      margin-top: 20px;
    }

    .recommendations h3 {
      color: #856404;
      margin-bottom: 15px;
      font-size: 16px;
    }

    .recommendations ul {
      margin-left: 20px;
      color: #856404;
    }

    .recommendations li {
      margin-bottom: 8px;
      line-height: 1.6;
    }

    .error-message {
      background: #f8d7da;
      border-left: 4px solid #dc3545;
      padding: 15px;
      border-radius: 8px;
      color: #721c24;
      margin-top: 15px;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    .spinner {
      display: inline-block;
      width: 20px;
      height: 20px;
      border: 3px solid rgba(255,255,255,0.3);
      border-radius: 50%;
      border-top-color: white;
      animation: spin 0.8s linear infinite;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>ğŸš€ ç½‘é¡µå¹¶å‘åŠ è½½æµ‹è¯•å·¥å…·</h1>
      <p class="subtitle">æµ‹è¯•ç½‘é¡µåœ¨å¤šç”¨æˆ·å¹¶å‘è®¿é—®æ—¶çš„æ€§èƒ½è¡¨ç°</p>
    </div>

    <div class="config-panel">
      <h2 style="color: #2c3e50; margin-bottom: 25px; font-size: 20px;">æµ‹è¯•é…ç½®</h2>
      
      <div class="form-group">
        <label for="testUrl">æµ‹è¯•ç½‘å€</label>
        <input type="text" id="testUrl" placeholder="ä¾‹å¦‚: https://example.com" value="https://weiqichen77.github.io/jkw-7element-alloy-database/">
        <div class="input-hint">è¾“å…¥æ‚¨è¦æµ‹è¯•çš„å®Œæ•´ç½‘å€</div>
      </div>

      <div class="form-group">
        <label for="concurrentUsers">å¹¶å‘ç”¨æˆ·æ•°</label>
        <input type="number" id="concurrentUsers" min="1" max="500" value="100">
        <div class="input-hint">åŒæ—¶è®¿é—®ç½‘é¡µçš„ç”¨æˆ·æ•°é‡ï¼ˆå»ºè®®: 1-500ï¼‰</div>
      </div>

      <div class="form-group">
        <label for="requestsPerUser">æ¯ç”¨æˆ·è¯·æ±‚æ¬¡æ•°</label>
        <input type="number" id="requestsPerUser" min="1" max="20" value="3">
        <div class="input-hint">æ¯ä¸ªç”¨æˆ·å‘èµ·çš„è¯·æ±‚æ¬¡æ•°ï¼ˆæ¨¡æ‹ŸçœŸå®æµè§ˆè¡Œä¸ºï¼‰</div>
      </div>

      <div class="button-group">
        <button class="btn-primary" id="startTest">
          <span id="startBtnText">å¼€å§‹æµ‹è¯•</span>
        </button>
        <button class="btn-secondary" id="stopTest" disabled>åœæ­¢æµ‹è¯•</button>
      </div>
    </div>

    <div class="progress-panel" id="progressPanel">
      <h2 style="color: #2c3e50; margin-bottom: 20px; font-size: 20px;">æµ‹è¯•è¿›è¡Œä¸­...</h2>
      <div class="progress-bar-container">
        <div class="progress-bar" id="progressBar">0%</div>
      </div>
      <div class="status-text" id="statusText">å‡†å¤‡å¼€å§‹æµ‹è¯•...</div>
    </div>

    <div class="results-panel" id="resultsPanel">
      <h2 style="color: #2c3e50; margin-bottom: 25px; font-size: 20px;">æµ‹è¯•ç»“æœ</h2>
      
      <div class="score-display">
        <div style="font-size: 16px; opacity: 0.9;">ç»¼åˆè¯„åˆ†</div>
        <div class="score-number" id="scoreNumber">--</div>
        <div class="score-grade" id="scoreGrade">--</div>
        <div class="score-desc" id="scoreDesc">--</div>
      </div>

      <div class="stats-grid">
        <div class="stat-card">
          <div class="stat-label">æ€»è¯·æ±‚æ•°</div>
          <div class="stat-value" id="totalRequests">--</div>
        </div>
        <div class="stat-card">
          <div class="stat-label">æˆåŠŸç‡</div>
          <div class="stat-value" id="successRate">--<span class="stat-unit">%</span></div>
        </div>
        <div class="stat-card">
          <div class="stat-label">å¹³å‡å“åº”æ—¶é—´</div>
          <div class="stat-value" id="avgResponseTime">--<span class="stat-unit">ms</span></div>
        </div>
        <div class="stat-card">
          <div class="stat-label">æµ‹è¯•æ—¶é•¿</div>
          <div class="stat-value" id="testDuration">--<span class="stat-unit">ç§’</span></div>
        </div>
      </div>

      <h3 style="color: #2c3e50; margin-bottom: 15px; font-size: 18px;">è¯¦ç»†ç»Ÿè®¡</h3>
      <table class="details-table">
        <thead>
          <tr>
            <th>æŒ‡æ ‡</th>
            <th>æ•°å€¼</th>
            <th>è¯´æ˜</th>
          </tr>
        </thead>
        <tbody id="detailsTableBody">
          <!-- åŠ¨æ€å¡«å…… -->
        </tbody>
      </table>

      <div id="recommendationsContainer"></div>
    </div>
  </div>

  <script>
    class LoadTester {
      constructor() {
        this.isRunning = false;
        this.shouldStop = false;
        this.stats = {
          totalRequests: 0,
          successfulRequests: 0,
          failedRequests: 0,
          responseTimes: [],
          startTime: 0,
          endTime: 0
        };
      }

      async makeRequest(url) {
        const startTime = performance.now();
        
        try {
          const response = await fetch(url, {
            method: 'GET',
            mode: 'no-cors', // å…è®¸è·¨åŸŸè¯·æ±‚
            cache: 'no-cache'
          });
          
          const responseTime = performance.now() - startTime;
          
          // no-cors æ¨¡å¼ä¸‹æ— æ³•è¯»å–å“åº”ï¼Œä½†èƒ½æµ‹è¯•åŠ è½½æ—¶é—´
          return {
            success: true,
            responseTime: responseTime,
            statusCode: 0 // no-cors æ¨¡å¼æ— æ³•è·å–çŠ¶æ€ç 
          };
        } catch (error) {
          const responseTime = performance.now() - startTime;
          return {
            success: false,
            responseTime: responseTime,
            error: error.message
          };
        }
      }

      async simulateUser(userId, url, requestsPerUser, onProgress) {
        const results = [];
        
        for (let i = 0; i < requestsPerUser; i++) {
          if (this.shouldStop) break;
          
          const result = await this.makeRequest(url);
          results.push(result);
          
          this.stats.totalRequests++;
          if (result.success) {
            this.stats.successfulRequests++;
            this.stats.responseTimes.push(result.responseTime);
          } else {
            this.stats.failedRequests++;
          }
          
          if (onProgress) {
            onProgress(this.stats.totalRequests);
          }
          
          // è¯·æ±‚ä¹‹é—´çš„å°å»¶è¿Ÿï¼ˆæ¨¡æ‹ŸçœŸå®ç”¨æˆ·è¡Œä¸ºï¼‰
          if (i < requestsPerUser - 1) {
            await new Promise(resolve => setTimeout(resolve, 100 + Math.random() * 200));
          }
        }
        
        return results;
      }

      calculateStats() {
        const times = this.stats.responseTimes.sort((a, b) => a - b);
        const len = times.length;
        
        if (len === 0) {
          return {
            avg: 0, min: 0, max: 0,
            p50: 0, p90: 0, p95: 0, p99: 0
          };
        }
        
        const sum = times.reduce((a, b) => a + b, 0);
        const avg = sum / len;
        
        return {
          avg: avg,
          min: times[0],
          max: times[len - 1],
          p50: times[Math.floor(len * 0.5)],
          p90: times[Math.floor(len * 0.9)],
          p95: times[Math.floor(len * 0.95)],
          p99: times[Math.floor(len * 0.99)]
        };
      }

      evaluatePerformance(avgResponseTime, successRate) {
        let score = 100;
        
        // åŸºäºå“åº”æ—¶é—´è¯„åˆ†
        if (avgResponseTime > 5000) score -= 50;
        else if (avgResponseTime > 3000) score -= 40;
        else if (avgResponseTime > 2000) score -= 30;
        else if (avgResponseTime > 1000) score -= 20;
        else if (avgResponseTime > 500) score -= 10;
        
        // åŸºäºæˆåŠŸç‡è¯„åˆ†
        if (successRate < 50) score -= 50;
        else if (successRate < 80) score -= 30;
        else if (successRate < 95) score -= 15;
        else if (successRate < 99) score -= 5;
        
        score = Math.max(0, score);
        
        let grade, description;
        if (score >= 95) {
          grade = 'A+';
          description = 'ä¼˜ç§€ - ç½‘é¡µåŠ è½½éå¸¸æµç•…';
        } else if (score >= 85) {
          grade = 'A';
          description = 'è‰¯å¥½ - ç½‘é¡µåŠ è½½æµç•…';
        } else if (score >= 75) {
          grade = 'B';
          description = 'ä¸­ç­‰ - ç½‘é¡µåŠ è½½åŸºæœ¬æµç•…';
        } else if (score >= 60) {
          grade = 'C';
          description = 'åˆæ ¼ - ç½‘é¡µåŠ è½½æœ‰äº›å¡é¡¿';
        } else if (score >= 40) {
          grade = 'D';
          description = 'è¾ƒå·® - ç½‘é¡µåŠ è½½æ˜æ˜¾å¡é¡¿';
        } else {
          grade = 'F';
          description = 'ä¸åˆæ ¼ - ç½‘é¡µåŠ è½½ä¸¥é‡å¡é¡¿æˆ–å¤±è´¥';
        }
        
        return { score, grade, description };
      }

      async start(url, concurrentUsers, requestsPerUser) {
        if (this.isRunning) return;
        
        this.isRunning = true;
        this.shouldStop = false;
        this.stats = {
          totalRequests: 0,
          successfulRequests: 0,
          failedRequests: 0,
          responseTimes: [],
          startTime: Date.now(),
          endTime: 0
        };

        const totalRequests = concurrentUsers * requestsPerUser;
        
        const onProgress = (completed) => {
          const percentage = (completed / totalRequests * 100).toFixed(1);
          updateProgress(percentage, `å·²å®Œæˆ ${completed}/${totalRequests} ä¸ªè¯·æ±‚`);
        };

        // åˆ›å»ºå¹¶å‘ç”¨æˆ·
        const userPromises = [];
        for (let i = 0; i < concurrentUsers; i++) {
          if (this.shouldStop) break;
          
          const promise = this.simulateUser(i, url, requestsPerUser, onProgress);
          userPromises.push(promise);
          
          // ç¨å¾®é”™å¼€ç”¨æˆ·å¼€å§‹æ—¶é—´ï¼ˆæ¨¡æ‹ŸçœŸå®åœºæ™¯ï¼‰
          await new Promise(resolve => setTimeout(resolve, 10));
        }

        // ç­‰å¾…æ‰€æœ‰ç”¨æˆ·å®Œæˆ
        await Promise.all(userPromises);
        
        this.stats.endTime = Date.now();
        this.isRunning = false;
        
        return this.getResults();
      }

      stop() {
        this.shouldStop = true;
      }

      getResults() {
        const duration = (this.stats.endTime - this.stats.startTime) / 1000;
        const successRate = this.stats.totalRequests > 0
          ? (this.stats.successfulRequests / this.stats.totalRequests) * 100
          : 0;
        
        const responseStats = this.calculateStats();
        const performance = this.evaluatePerformance(responseStats.avg, successRate);
        
        return {
          totalRequests: this.stats.totalRequests,
          successfulRequests: this.stats.successfulRequests,
          failedRequests: this.stats.failedRequests,
          successRate: successRate,
          duration: duration,
          responseStats: responseStats,
          performance: performance
        };
      }
    }

    // UI æ§åˆ¶
    const tester = new LoadTester();
    
    const elements = {
      testUrl: document.getElementById('testUrl'),
      concurrentUsers: document.getElementById('concurrentUsers'),
      requestsPerUser: document.getElementById('requestsPerUser'),
      startBtn: document.getElementById('startTest'),
      stopBtn: document.getElementById('stopTest'),
      startBtnText: document.getElementById('startBtnText'),
      progressPanel: document.getElementById('progressPanel'),
      progressBar: document.getElementById('progressBar'),
      statusText: document.getElementById('statusText'),
      resultsPanel: document.getElementById('resultsPanel')
    };

    function updateProgress(percentage, statusText) {
      elements.progressBar.style.width = percentage + '%';
      elements.progressBar.textContent = percentage + '%';
      elements.statusText.textContent = statusText;
    }

    function displayResults(results) {
      // æ˜¾ç¤ºå¾—åˆ†
      document.getElementById('scoreNumber').textContent = results.performance.score;
      document.getElementById('scoreGrade').textContent = results.performance.grade;
      document.getElementById('scoreDesc').textContent = results.performance.description;
      
      // æ˜¾ç¤ºåŸºæœ¬ç»Ÿè®¡
      document.getElementById('totalRequests').textContent = results.totalRequests;
      document.getElementById('successRate').textContent = results.successRate.toFixed(2);
      document.getElementById('avgResponseTime').textContent = results.responseStats.avg.toFixed(0);
      document.getElementById('testDuration').textContent = results.duration.toFixed(2);
      
      // æ˜¾ç¤ºè¯¦ç»†ç»Ÿè®¡è¡¨æ ¼
      const detailsBody = document.getElementById('detailsTableBody');
      detailsBody.innerHTML = `
        <tr>
          <td>æˆåŠŸè¯·æ±‚æ•°</td>
          <td>${results.successfulRequests}</td>
          <td>æˆåŠŸå®Œæˆçš„è¯·æ±‚æ•°é‡</td>
        </tr>
        <tr>
          <td>å¤±è´¥è¯·æ±‚æ•°</td>
          <td>${results.failedRequests}</td>
          <td>å¤±è´¥æˆ–è¶…æ—¶çš„è¯·æ±‚æ•°é‡</td>
        </tr>
        <tr>
          <td>æœ€å°å“åº”æ—¶é—´</td>
          <td>${results.responseStats.min.toFixed(0)} ms</td>
          <td>æœ€å¿«çš„è¯·æ±‚å“åº”æ—¶é—´</td>
        </tr>
        <tr>
          <td>æœ€å¤§å“åº”æ—¶é—´</td>
          <td>${results.responseStats.max.toFixed(0)} ms</td>
          <td>æœ€æ…¢çš„è¯·æ±‚å“åº”æ—¶é—´</td>
        </tr>
        <tr>
          <td>ä¸­ä½æ•° (P50)</td>
          <td>${results.responseStats.p50.toFixed(0)} ms</td>
          <td>50%çš„è¯·æ±‚å“åº”æ—¶é—´ä½äºæ­¤å€¼</td>
        </tr>
        <tr>
          <td>P90</td>
          <td>${results.responseStats.p90.toFixed(0)} ms</td>
          <td>90%çš„è¯·æ±‚å“åº”æ—¶é—´ä½äºæ­¤å€¼</td>
        </tr>
        <tr>
          <td>P95</td>
          <td>${results.responseStats.p95.toFixed(0)} ms</td>
          <td>95%çš„è¯·æ±‚å“åº”æ—¶é—´ä½äºæ­¤å€¼</td>
        </tr>
        <tr>
          <td>P99</td>
          <td>${results.responseStats.p99.toFixed(0)} ms</td>
          <td>99%çš„è¯·æ±‚å“åº”æ—¶é—´ä½äºæ­¤å€¼</td>
        </tr>
      `;
      
      // æ˜¾ç¤ºä¼˜åŒ–å»ºè®®
      const recommendations = [];
      if (results.responseStats.avg > 1000) {
        recommendations.push('å“åº”æ—¶é—´è¾ƒæ…¢ï¼Œå»ºè®®ä¼˜åŒ–æœåŠ¡å™¨æ€§èƒ½æˆ–ä½¿ç”¨CDNåŠ é€Ÿ');
      }
      if (results.successRate < 99) {
        recommendations.push('æˆåŠŸç‡åä½ï¼Œå»ºè®®æ£€æŸ¥æœåŠ¡å™¨ç¨³å®šæ€§å’Œç½‘ç»œè¿æ¥');
      }
      if (results.failedRequests > 0) {
        recommendations.push('å­˜åœ¨å¤±è´¥è¯·æ±‚ï¼Œå»ºè®®æ£€æŸ¥ç½‘ç»œé…ç½®å’ŒCORSè®¾ç½®');
      }
      if (results.responseStats.max > results.responseStats.avg * 3) {
        recommendations.push('å“åº”æ—¶é—´æ³¢åŠ¨è¾ƒå¤§ï¼Œå»ºè®®ä¼˜åŒ–èµ„æºåŠ è½½å’Œç¼“å­˜ç­–ç•¥');
      }
      
      const recContainer = document.getElementById('recommendationsContainer');
      if (recommendations.length > 0) {
        recContainer.innerHTML = `
          <div class="recommendations">
            <h3>ğŸ’¡ ä¼˜åŒ–å»ºè®®</h3>
            <ul>
              ${recommendations.map(rec => `<li>${rec}</li>`).join('')}
            </ul>
          </div>
        `;
      } else {
        recContainer.innerHTML = '';
      }
      
      // æ˜¾ç¤ºç»“æœé¢æ¿
      elements.resultsPanel.classList.add('show');
      
      // æ»šåŠ¨åˆ°ç»“æœåŒºåŸŸ
      elements.resultsPanel.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
    }

    elements.startBtn.addEventListener('click', async () => {
      const url = elements.testUrl.value.trim();
      const concurrentUsers = parseInt(elements.concurrentUsers.value);
      const requestsPerUser = parseInt(elements.requestsPerUser.value);
      
      // éªŒè¯è¾“å…¥
      if (!url) {
        alert('è¯·è¾“å…¥æµ‹è¯•ç½‘å€');
        return;
      }
      
      if (concurrentUsers < 1 || concurrentUsers > 500) {
        alert('å¹¶å‘ç”¨æˆ·æ•°åº”åœ¨1-500ä¹‹é—´');
        return;
      }
      
      if (requestsPerUser < 1 || requestsPerUser > 20) {
        alert('æ¯ç”¨æˆ·è¯·æ±‚æ¬¡æ•°åº”åœ¨1-20ä¹‹é—´');
        return;
      }
      
      // æ›´æ–°UIçŠ¶æ€
      elements.startBtn.disabled = true;
      elements.stopBtn.disabled = false;
      elements.progressPanel.classList.add('show');
      elements.resultsPanel.classList.remove('show');
      elements.startBtnText.innerHTML = '<span class="spinner"></span>';
      
      updateProgress(0, 'æ­£åœ¨å¯åŠ¨æµ‹è¯•...');
      
      try {
        // å¼€å§‹æµ‹è¯•
        const results = await tester.start(url, concurrentUsers, requestsPerUser);
        
        // æ˜¾ç¤ºç»“æœ
        updateProgress(100, 'æµ‹è¯•å®Œæˆï¼');
        displayResults(results);
        
      } catch (error) {
        console.error('æµ‹è¯•å¤±è´¥:', error);
        elements.progressPanel.innerHTML += `
          <div class="error-message">
            âŒ æµ‹è¯•å¤±è´¥: ${error.message}
          </div>
        `;
      } finally {
        elements.startBtn.disabled = false;
        elements.stopBtn.disabled = true;
        elements.startBtnText.textContent = 'å¼€å§‹æµ‹è¯•';
      }
    });

    elements.stopBtn.addEventListener('click', () => {
      tester.stop();
      elements.stopBtn.disabled = true;
      updateProgress(0, 'æµ‹è¯•å·²åœæ­¢');
    });

    // å›è½¦é”®è§¦å‘æµ‹è¯•
    [elements.testUrl, elements.concurrentUsers, elements.requestsPerUser].forEach(input => {
      input.addEventListener('keypress', (e) => {
        if (e.key === 'Enter' && !elements.startBtn.disabled) {
          elements.startBtn.click();
        }
      });
    });
  </script>
</body>
</html>
