<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Feature Testing</title>
    <style>
        body { font-family: Arial, sans-serif; max-width: 1200px; margin: 20px auto; padding: 20px; }
        .test-section { margin: 30px 0; padding: 20px; border: 2px solid #ddd; border-radius: 8px; }
        .test-section h2 { color: #667eea; }
        .success { color: green; font-weight: bold; }
        .fail { color: red; font-weight: bold; }
        .code { background: #f5f5f5; padding: 10px; border-radius: 4px; font-family: monospace; }
        button { padding: 10px 20px; background: #667eea; color: white; border: none; border-radius: 5px; cursor: pointer; margin: 10px 5px; }
        button:hover { background: #5568d3; }
        #result { margin-top: 20px; }
    </style>
</head>
<body>
    <h1>V2 Feature Testing Dashboard</h1>
    <p>æµ‹è¯•éƒ¨ç½²ç½‘ç«™çš„5å¤§æ–°åŠŸèƒ½ / Testing 5 Major Features</p>

    <div class="test-section">
        <h2>æµ‹è¯• 1: å¤æ‚ç•Œé¢æ ‡è®° (Complex Interface Notation)</h2>
        <p>æµ‹è¯•ææ–™: Al2Cu3/Nb4Ta5 (ID: 101)</p>
        <button onclick="testFeature1()">è¿è¡Œæµ‹è¯• / Run Test</button>
        <div id="test1-result"></div>
    </div>

    <div class="test-section">
        <h2>æµ‹è¯• 2: éæ™¶å‰ç¼€æ ‡è®° (Amorphous Prefix)</h2>
        <p>æµ‹è¯•ææ–™: a-Al2Nb3 (ID: 102) å’Œ Al2Cu3/a-Nb4Ta5 (ID: 103)</p>
        <button onclick="testFeature2()">è¿è¡Œæµ‹è¯• / Run Test</button>
        <div id="test2-result"></div>
    </div>

    <div class="test-section">
        <h2>æµ‹è¯• 3: åŒé€‰æ‹©å™¨ç­›é€‰ (Dual Selector Filtering)</h2>
        <p>æ£€æŸ¥æ˜¯å¦æœ‰ç‹¬ç«‹çš„æ¸©åº¦å’Œæ¥æºé€‰æ‹©å™¨</p>
        <button onclick="testFeature3()">è¿è¡Œæµ‹è¯• / Run Test</button>
        <div id="test3-result"></div>
    </div>

    <div class="test-section">
        <h2>æµ‹è¯• 4: POSCARä¸‹è½½ (POSCAR Download)</h2>
        <p>æ£€æŸ¥ä¸‹è½½é“¾æ¥æ˜¯å¦å­˜åœ¨</p>
        <button onclick="testFeature4()">è¿è¡Œæµ‹è¯• / Run Test</button>
        <div id="test4-result"></div>
    </div>

    <div class="test-section">
        <h2>æµ‹è¯• 5: å¼¹æ€§å¸¸æ•°çŸ©é˜µ (Elastic Constants Matrix)</h2>
        <p>æ£€æŸ¥æ˜¯å¦æœ‰ææ–™åŒ…å«elasticConstantsæ•°æ®</p>
        <button onclick="testFeature5()">è¿è¡Œæµ‹è¯• / Run Test</button>
        <div id="test5-result"></div>
    </div>

    <div class="test-section" style="background: #f0f0f0;">
        <h2>ğŸš€ ä¸€é”®è¿è¡Œæ‰€æœ‰æµ‹è¯• / Run All Tests</h2>
        <button onclick="runAllTests()" style="background: #2ecc71; font-size: 16px; padding: 15px 30px;">è¿è¡Œæ‰€æœ‰æµ‹è¯• / Run All Tests</button>
    </div>

    <script>
        const baseUrl = 'https://wqchen007.github.io/jkw-7element-alloy-database';

        async function testFeature1() {
            const resultDiv = document.getElementById('test1-result');
            resultDiv.innerHTML = '<p>æ­£åœ¨æµ‹è¯•... / Testing...</p>';
            
            try {
                const response = await fetch(`${baseUrl}/data/materials.json`);
                const data = await response.json();
                const material = data.find(m => m.id === 101);
                
                if (!material) {
                    resultDiv.innerHTML = '<p class="fail">âŒ å¤±è´¥: æœªæ‰¾åˆ°ææ–™101 / Material 101 not found</p>';
                    return;
                }
                
                const composition = material.composition;
                resultDiv.innerHTML = `
                    <p class="success">âœ… æˆåŠŸæ‰¾åˆ°ææ–™101 / Found material 101</p>
                    <div class="code">
                        <p><strong>Name:</strong> ${material.name}</p>
                        <p><strong>Composition (raw):</strong> ${composition}</p>
                        <p><strong>Type:</strong> ${material.type}</p>
                    </div>
                    <p>${composition.includes('/') ? '<span class="success">âœ… åŒ…å«ç•Œé¢åˆ†éš”ç¬¦ / Contains interface separator</span>' : '<span class="fail">âŒ ç¼ºå°‘ç•Œé¢åˆ†éš”ç¬¦</span>'}</p>
                `;
            } catch (error) {
                resultDiv.innerHTML = `<p class="fail">âŒ é”™è¯¯ / Error: ${error.message}</p>`;
            }
        }

        async function testFeature2() {
            const resultDiv = document.getElementById('test2-result');
            resultDiv.innerHTML = '<p>æ­£åœ¨æµ‹è¯•... / Testing...</p>';
            
            try {
                const response = await fetch(`${baseUrl}/data/materials.json`);
                const data = await response.json();
                const material102 = data.find(m => m.id === 102);
                const material103 = data.find(m => m.id === 103);
                
                let html = '';
                
                if (material102) {
                    const hasPrefix = material102.composition.startsWith('a-');
                    html += `
                        <p class="success">âœ… æ‰¾åˆ°ææ–™102 / Found material 102</p>
                        <div class="code">
                            <p><strong>Composition:</strong> ${material102.composition}</p>
                        </div>
                        <p>${hasPrefix ? '<span class="success">âœ… åŒ…å«a-å‰ç¼€ / Contains a- prefix</span>' : '<span class="fail">âŒ ç¼ºå°‘a-å‰ç¼€</span>'}</p>
                    `;
                }
                
                if (material103) {
                    const hasPrefix = material103.composition.includes('a-');
                    html += `
                        <p class="success">âœ… æ‰¾åˆ°ææ–™103 / Found material 103</p>
                        <div class="code">
                            <p><strong>Composition:</strong> ${material103.composition}</p>
                        </div>
                        <p>${hasPrefix ? '<span class="success">âœ… åŒ…å«a-å‰ç¼€ / Contains a- prefix in interface</span>' : '<span class="fail">âŒ ç¼ºå°‘a-å‰ç¼€</span>'}</p>
                    `;
                }
                
                resultDiv.innerHTML = html || '<p class="fail">âŒ æœªæ‰¾åˆ°æµ‹è¯•ææ–™ / Test materials not found</p>';
            } catch (error) {
                resultDiv.innerHTML = `<p class="fail">âŒ é”™è¯¯ / Error: ${error.message}</p>`;
            }
        }

        async function testFeature3() {
            const resultDiv = document.getElementById('test3-result');
            resultDiv.innerHTML = '<p>æ­£åœ¨æµ‹è¯•... / Testing...</p>';
            
            try {
                const response = await fetch(`${baseUrl}/js/app.js`);
                const code = await response.text();
                
                const hasFilterFunction = code.includes('filterDetailData');
                const hasTempSelect = code.includes('tempSelect');
                const hasSourceSelect = code.includes('sourceSelect');
                const hasDualSelectors = code.includes('Temperature:') && code.includes('Source:');
                
                let html = '<h3>ä»£ç æ£€æŸ¥ç»“æœ / Code Check Results:</h3><ul>';
                html += `<li>${hasFilterFunction ? '<span class="success">âœ…</span>' : '<span class="fail">âŒ</span>'} filterDetailData å‡½æ•° / function</li>`;
                html += `<li>${hasTempSelect ? '<span class="success">âœ…</span>' : '<span class="fail">âŒ</span>'} tempSelect é€‰æ‹©å™¨ / selector</li>`;
                html += `<li>${hasSourceSelect ? '<span class="success">âœ…</span>' : '<span class="fail">âŒ</span>'} sourceSelect é€‰æ‹©å™¨ / selector</li>`;
                html += `<li>${hasDualSelectors ? '<span class="success">âœ…</span>' : '<span class="fail">âŒ</span>'} åŒé€‰æ‹©å™¨UI / Dual selector UI</li>`;
                html += '</ul>';
                
                if (hasFilterFunction && hasTempSelect && hasSourceSelect) {
                    html += '<p class="success">âœ… æ‰€æœ‰åŒé€‰æ‹©å™¨ç»„ä»¶éƒ½å·²éƒ¨ç½² / All dual selector components deployed</p>';
                } else {
                    html += '<p class="fail">âŒ ç¼ºå°‘éƒ¨åˆ†ç»„ä»¶ / Some components missing</p>';
                }
                
                resultDiv.innerHTML = html;
            } catch (error) {
                resultDiv.innerHTML = `<p class="fail">âŒ é”™è¯¯ / Error: ${error.message}</p>`;
            }
        }

        async function testFeature4() {
            const resultDiv = document.getElementById('test4-result');
            resultDiv.innerHTML = '<p>æ­£åœ¨æµ‹è¯•... / Testing...</p>';
            
            try {
                const response = await fetch(`${baseUrl}/js/app.js`);
                const code = await response.text();
                
                const hasDownloadButton = code.includes('Download POSCAR') || code.includes('ä¸‹è½½POSCAR');
                const hasPoscarLink = code.includes('.poscar');
                
                let html = '<h3>ä¸‹è½½åŠŸèƒ½æ£€æŸ¥ / Download Feature Check:</h3><ul>';
                html += `<li>${hasDownloadButton ? '<span class="success">âœ…</span>' : '<span class="fail">âŒ</span>'} ä¸‹è½½æŒ‰é’®æ–‡æœ¬ / Download button text</li>`;
                html += `<li>${hasPoscarLink ? '<span class="success">âœ…</span>' : '<span class="fail">âŒ</span>'} POSCAR é“¾æ¥ / POSCAR links</li>`;
                html += '</ul>';
                
                if (hasDownloadButton && hasPoscarLink) {
                    html += '<p class="success">âœ… POSCARä¸‹è½½åŠŸèƒ½å·²éƒ¨ç½² / POSCAR download feature deployed</p>';
                    html += '<p style="color: orange;">âš ï¸ æ³¨æ„: å®é™…æ–‡ä»¶éœ€è¦ä¸Šä¼ åˆ° data/poscar/ ç›®å½• / Note: Actual files need to be uploaded to data/poscar/</p>';
                } else {
                    html += '<p class="fail">âŒ POSCARä¸‹è½½åŠŸèƒ½æœªæ‰¾åˆ° / POSCAR download feature not found</p>';
                }
                
                resultDiv.innerHTML = html;
            } catch (error) {
                resultDiv.innerHTML = `<p class="fail">âŒ é”™è¯¯ / Error: ${error.message}</p>`;
            }
        }

        async function testFeature5() {
            const resultDiv = document.getElementById('test5-result');
            resultDiv.innerHTML = '<p>æ­£åœ¨æµ‹è¯•... / Testing...</p>';
            
            try {
                // Check data
                const dataResponse = await fetch(`${baseUrl}/data/materials.json`);
                const data = await dataResponse.json();
                
                let materialsWithElastic = 0;
                let totalDataPoints = 0;
                let exampleMaterial = null;
                
                data.forEach(material => {
                    material.data.forEach(dataPoint => {
                        totalDataPoints++;
                        if (dataPoint.properties?.mechanics?.elasticConstants) {
                            materialsWithElastic++;
                            if (!exampleMaterial) {
                                exampleMaterial = {
                                    name: material.name,
                                    id: material.id,
                                    constants: dataPoint.properties.mechanics.elasticConstants
                                };
                            }
                        }
                    });
                });
                
                // Check code
                const codeResponse = await fetch(`${baseUrl}/js/app.js`);
                const code = await codeResponse.text();
                const hasMatrixDisplay = code.includes('elastic-constants-section');
                const hasCijMatrix = code.includes('cij-matrix');
                
                // Check CSS
                const cssResponse = await fetch(`${baseUrl}/css/style.css`);
                const css = await cssResponse.text();
                const hasCss = css.includes('elastic-constants-section');
                
                let html = '<h3>å¼¹æ€§å¸¸æ•°æ£€æŸ¥ç»“æœ / Elastic Constants Check:</h3>';
                html += `<p><strong>æ€»æ•°æ®ç‚¹ / Total data points:</strong> ${totalDataPoints}</p>`;
                html += `<p><strong>åŒ…å«å¼¹æ€§å¸¸æ•°çš„æ•°æ®ç‚¹ / Data points with elastic constants:</strong> <span class="success">${materialsWithElastic}</span></p>`;
                html += '<h4>ä»£ç ç»„ä»¶ / Code Components:</h4><ul>';
                html += `<li>${hasMatrixDisplay ? '<span class="success">âœ…</span>' : '<span class="fail">âŒ</span>'} çŸ©é˜µæ˜¾ç¤ºHTML / Matrix display HTML</li>`;
                html += `<li>${hasCijMatrix ? '<span class="success">âœ…</span>' : '<span class="fail">âŒ</span>'} Cij çŸ©é˜µè¡¨æ ¼ / Cij matrix table</li>`;
                html += `<li>${hasCss ? '<span class="success">âœ…</span>' : '<span class="fail">âŒ</span>'} CSS æ ·å¼ / CSS styles</li>`;
                html += '</ul>';
                
                if (exampleMaterial) {
                    const matrix = exampleMaterial.constants.matrix || exampleMaterial.constants;
                    html += `<h4>ç¤ºä¾‹æ•°æ® / Example Data:</h4>`;
                    html += `<p><strong>ææ–™ / Material:</strong> ${exampleMaterial.name} (ID: ${exampleMaterial.id})</p>`;
                    html += `<p><strong>C11:</strong> ${matrix[0][0]} GPa</p>`;
                }
                
                if (materialsWithElastic > 0 && hasMatrixDisplay && hasCijMatrix && hasCss) {
                    html += '<p class="success">âœ… å¼¹æ€§å¸¸æ•°åŠŸèƒ½å®Œå…¨éƒ¨ç½² / Elastic constants feature fully deployed</p>';
                } else {
                    html += '<p class="fail">âŒ å¼¹æ€§å¸¸æ•°åŠŸèƒ½ä¸å®Œæ•´ / Elastic constants feature incomplete</p>';
                }
                
                resultDiv.innerHTML = html;
            } catch (error) {
                resultDiv.innerHTML = `<p class="fail">âŒ é”™è¯¯ / Error: ${error.message}</p>`;
            }
        }

        async function runAllTests() {
            await testFeature1();
            await new Promise(resolve => setTimeout(resolve, 500));
            await testFeature2();
            await new Promise(resolve => setTimeout(resolve, 500));
            await testFeature3();
            await new Promise(resolve => setTimeout(resolve, 500));
            await testFeature4();
            await new Promise(resolve => setTimeout(resolve, 500));
            await testFeature5();
            
            alert('æ‰€æœ‰æµ‹è¯•å®Œæˆï¼è¯·æŸ¥çœ‹ç»“æœã€‚/ All tests completed! Please check the results.');
        }
    </script>
</body>
</html>
